<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <script>
        /**
        * Класс, объекты которого описывают параметры гамбургера. 
        * 
        * @constructor
        * @param size        Размер
        * @param stuffing    Начинка
        * @throws {HamburgerException}  При неправильном использовании
        */
        function Hamburger(size, stuffing) {
            if(size == Hamburger.SIZE_LARGE || size == Hamburger.SIZE_SMALL)
                this.size = size;
            else
                HamburgerException("Unexpected size parameter\nUse: \nHamburger.SIZE_LARGE \nHamburger.SIZE_SMALL");
            
            this.stuffing = [];
            for ( let i in stuffing)
                if(stuffing[i] == Hamburger.STUFFING_CHEESE || stuffing[i] == Hamburger.STUFFING_SALAD || stuffing[i] == Hamburger.STUFFING_POTATO) {
                    if (stuffing[i] == Hamburger.STUFFING_CHEESE && this.stuffing.includes(Hamburger.STUFFING_CHEESE))
                        HamburgerException("Your Hamburger already contains cheese");
                    else if (stuffing[i] == Hamburger.STUFFING_SALAD && this.stuffing.includes(Hamburger.STUFFING_SALAD))
                        HamburgerException("Your Hamburger already contains salad");
                    else if (stuffing[i] == Hamburger.STUFFING_POTATO && this.stuffing.includes(Hamburger.STUFFING_POTATO))
                        HamburgerException("Your Hamburger already contains potato");
                    else
                        this.stuffing.push(stuffing[i]);
                }
                else {
                    HamburgerException("Unexpected stuffing parameter\nUse: \nHamburger.STUFFING_CHEESE \nHamburger.STUFFING_SALAD \nHamburger.STUFFING_POTATO");
                    this.stuffing = "";
                    break;
                }
        } 
        /* Размеры, виды начинок и добавок */
        Hamburger.SIZE_SMALL = {price:50, cal:20};
        Hamburger.SIZE_LARGE = {price:100, cal:40};
        Hamburger.STUFFING_CHEESE = {price:10, cal:20};
        Hamburger.STUFFING_SALAD = {price:20, cal:5};
        Hamburger.STUFFING_POTATO = {price:15, cal:10};
        Hamburger.TOPPING_MAYO = {price:15, cal:0};
        Hamburger.TOPPING_SPICE = {price:20, cal:5};
        /**
        * Добавить добавку к гамбургеру. Можно добавить несколько
        * добавок, при условии, что они разные.
        * 
        * @param topping     Тип добавки
        * @throws {HamburgerException}  При неправильном использовании
        */
        Hamburger.prototype.addTopping = function (topping) {

            if(topping == Hamburger.STUFFING_CHEESE || topping == Hamburger.STUFFING_SALAD || topping == Hamburger.STUFFING_POTATO || topping == Hamburger.TOPPING_MAYO || topping == Hamburger.TOPPING_SPICE) {
                if (!this.stuffing.includes(topping))
                    this.stuffing.push(topping);
                else
                    HamburgerException("Such ingreedient is already exists");
            }
            else {
                HamburgerException("Unexpected topping\nUse: \nHamburger.STUFFING_CHEESE \nHamburger.STUFFING_SALAD \nHamburger.STUFFING_POTATO \nHamburger.TOPPING_MAYO \nHamburger.TOPPING_SPICE");
            }
        }
        /**
         * Убрать добавку, при условии, что она ранее была 
         * добавлена.
         * 
         * @param topping   Тип добавки
         * @throws {HamburgerException}  При неправильном использовании
         */
        Hamburger.prototype.removeTopping = function (topping) {
            
            if(this.stuffing.includes(topping)) {
                for (let st in this.stuffing) {
                    if (this.stuffing[st] == topping) {
                        delete this.stuffing[st];
                        break;
                    }
                }
            }
            else {
                HamburgerException("Such stuffing doesn't exist");
            }
        }
        /**
         * Получить список добавок.
         *
         * @return {Array} Массив добавленных добавок, содержит константы
         *                 Hamburger.TOPPING_*
         */
        Hamburger.prototype.getToppings = function () {
            let toppings = [];
            if (this.stuffing.includes(Hamburger.TOPPING_MAYO))
                toppings.push("Mato");
            if (this.stuffing.includes(Hamburger.TOPPING_SPICE))
                toppings.push("Spise");
            console.log("Toppings: " + toppings);
            return toppings;
        }
        /**
         * Узнать размер гамбургера
         */
        Hamburger.prototype.getSize = function () {
            return (this.size.price == 50) ? "Small size" : "Large size";
        }
        /**
         * Узнать начинку гамбургера
         */
        Hamburger.prototype.getStuffing = function () {
            let stuffing = "";
            for (st in this.stuffing) {
                if (this.stuffing[st].price == 20)
                    stuffing += "salad ";
                else if (this.stuffing[st].price == 15)
                    stuffing += "potato ";
                else
                    stuffing += "cheese ";
            }
            return stuffing;
        }
        /**
         * Узнать цену гамбургера
         * @return {Number} Цена в тугриках
         */
        Hamburger.prototype.calculatePrice = function () {
            let result = this.size.price;
            for (st in this.stuffing) {
                result += this.stuffing[st].price;
            }
            console.log("Total price: " + result);
            return result;
        }
        /**
         * Узнать калорийность
         * @return {Number} Калорийность в калориях
         */
        Hamburger.prototype.calculateCalories = function () {
            let result = this.size.cal;
            for (st in this.stuffing) {
                result += this.stuffing[st].cal;
            }
            console.log("Total calorage: " + result);
            return result;
            
        }
        /**
         * Представляет информацию об ошибке в ходе работы с гамбургером. 
         * Подробности хранятся в свойстве message.
         * @constructor 
         */
        function HamburgerException (message) { 
            console.log("Error: " + message);
        }
        
        // Демонстрация использования класса
        let a = new Hamburger(Hamburger.SIZE_SMALL, [Hamburger.STUFFING_SALAD, Hamburger.STUFFING_CHEESE, Hamburger.STUFFING_SALAD]) 
        // Error: Your Hamburger already contains salad
        
        a = new Hamburger(Hamburger.SIZE_SMALL, [Hamburger.STUFFING_SALAD, Hamburger.STUFFING_CHEESE, Hamburger.STUFFING_POTATO])
        console.log(a);
        // OK
        
        a.getStuffing(); // "salad cheese potato "
        
        a.getToppings(); // Toppings: 
        
        a.calculateCalories(); // Total calorage: 55
        
        a.calculatePrice(); // Total price: 95
        
        a.addTopping(Hamburger.TOPPING_SPICE);

        a.addTopping(Hamburger.TOPPING_SPICE); // Error: Such ingreedient is already exist
        
        a.getToppings(); // Toppings: Spise
        
        a.calculatePrice(); // Total price: 115
        
        a.addTopping(Hamburger.TOPPING_MAYO);
        a.getToppings(); // Toppings: Mato,Spise

        a.removeTopping(Hamburger.TOPPING_SPICE)
        a.getToppings(); // Toppings: Mato


    </script>
</body>
</html>
